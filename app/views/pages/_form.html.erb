 <ul id="tabs_page_form" class="subsection_tabs">  
     <li class="tab"><a href="#basic_page_details">Page Details</a></li>  
     <li class="tab"><a href="#advanced_page_details">Advanced Page Details</a></li>  
 </ul>
<% semantic_form_for @page do |form| %>

  <div id="basic_page_details">
    <%= collection_select :page, :parent_page_id, Page.root.full_set, :id, :title %></li>
    <%= form.input :title %>
  </div>
  <div id="advanced_page_details" class="optional">  
    <%= form.inputs :permalink, :visible, :active %>
    <%= form.inputs :css_class, :nav_item_css_class, :nav_item_parameters %>
    <%= form.inputs :redirect, :redirect_url %>
    <%= form.input :redirect_page, :include_blank => true  %>
    <%= form.inputs :file_name, :meta_keywords, :meta_description %>
  </div>
</div>  
  <%= form.buttons %>


<div id="<%= dom_id @page %>_content" class="admin_block ">
  <h3>Page Content</h3>
  
  <% @page.content_mappings.collect{|s| s.section }.uniq.each do |section| %>
    <h4><%= section.title %></h4>
    <ol>
      <% section_content = @page.content_mappings.select{|c| c.section == section } %>
    <% section_content.each do |content| %>
      <li>
        <%= content.asset.title %> <%= link_to "Edit", edit_polymorphic_path(content.asset) %>
        <div>
          <%# @asset = content.asset %>
          <%# form.inputs :for => @asset, :name => "Asset" %>
        </div>
      </li>
      
    <% end %>  
    </ol>
    <%= link_to "New Text Block", new_content_mapping_path(:page_id => @page.id, :section_id => section.id, :asset_type => 'TextBlock') %>
    <%= link_to "New Basic Image", new_content_mapping_path(:page_id => @page.id, :section_id => section.id, :asset_type => 'BasicImage') %>
  <% end %>
  
</div>
<% end %>
<script type="text/javascript" charset="utf-8">
  new Control.Tabs('tabs_page_form');  
</script>


